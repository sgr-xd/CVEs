# CVE 2024-6212 - Cross Site Scripting

**Researcher Name:** Guru Raghav Saravanan

**Product:** Student Attendance System using PHP and MySQL v1.0 (SourceCodester)

**Vulnerability:** **XSS** via Sqli injection


**POC:**
The vulnerability is present in **student_form.php line 6**. The *id* parameter is not sanitized and validated. This leads to sql injection when passed to *get_student(id=””)* in **actions.class.php line 127**. Using the SQL injection, I executed an XSS attack.

**student_form.php line 6:**

![student_form.php line 6:](/assets/CVE-2024-6212/pic1.png "student_form.php line 6:")

**actions.class.php line 127:**

![student_form.php line 6:](/assets/CVE-2024-6212/pic2.png "actions.class.php line 127:")

Here, the **id** parameter is directly used in the sql query without bound parameters.

**student_form.php line 22:**

![student_form.php line 6:](/assets/CVE-2024-6212/pic3.png "student_form.php line 22:")

**Attack screenshots:**

**Prerequisites:**

![Website](/assets/CVE-2024-6212/pic4.png "Website")

**Capturing the request by clicking the edit icon…**

![Request](/assets/CVE-2024-6212/pic5.png "Request")

**Here the vulnerable parameter is id.**

**UNION query:**

![Request](/assets/CVE-2024-6212/pic6.png "Request")

**Payload:**

**0x226175746f666f6375732f6f6e666f6375733d22616c65727428646f63756d656e742e636f6f6b69652922** => "autofocus/onfocus="alert(document.cookie)"

![Response](/assets/CVE-2024-6212/pic7.png "Response")

**Opening the response in the browser:**

![XSS](/assets/CVE-2024-6212/pic8.png "XSS")
